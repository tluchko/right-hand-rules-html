<!-- FILEPATH: /Users/tluchko/Documents/repo/right-hand-rules-html/index.html -->
<!DOCTYPE html>
<html>

<head>
    <title>Right Hand Rules</title>
    <script>
        var knownDir = '';
        // directions are matched here. E.g, 'out of page' anx 'xy+x' go together
        // var linear_directions = { 'out of the page': [0, 0, 1], 'into the page': [0, 0, -1], 'up': [0, 1, 0], 'down': [0, -1, 0], 'right': [1, 0, 0], 'left': [-1, 0, 0]};
        var linear_directions = ['left', 'right', 'down', 'up', 'into the page', 'out of the page'];
        // Positive means clockwise staring down the axis. Negative means counterclockwise staring down the axis.
        // var loop_directions = { 'xy+z': [1, 1, 0], 'xy-z': [-1, -1, 0], 'xz+y': [1, 0, 1], 'xz-y': [-1, 0, -1], 'yz+x': [0, 1, 1], 'yz-x': [0, -1, -1]};
        var loop_directions = ['yz-x', 'yz+x', 'xz-y', 'xz+y', 'xy-z', 'xy+z'];

        var knownDirections;
        var unknownDirections;

        // Add an event listener to each button
        var buttons = document.querySelectorAll("div.buttonGrid button");
        var buttons = document.querySelectorAll("div.buttonGrid button");
        buttons.forEach(function (button) {
            button.addEventListener("click", function () {
                // Change the border color of the clicked button
                button.style.borderColor = "red";
                // Change the border color of all other buttons back to the original color
                buttons.forEach(function (otherButton) {
                    if (otherButton !== button) {
                        otherButton.style.borderColor = "";
                    }
                });
            });
        });

        function checkAnswer(id) {
            button = document.getElementById(id)
            direction = button.value;
            var unknownIndex = unknownDirections.indexOf(direction);
            var knownIndex = knownDirections.indexOf(knownDir);
            if (unknownIndex == knownIndex) {
                document.getElementById("feedback").innerHTML = 'Correct!';
                // Change the border color of the clicked button
                button.style.borderColor = "green";
            } else {
                document.getElementById("feedback").innerHTML = `Wrong`;
                // Change the border color of the clicked button
                button.style.borderColor = "red";
            }
        }



        function nextImage() {
            /* Use a cyclic permuation of the vectors.  I.e., 
                known1, known2, unknown
                velocity, b-field, force
                b-field, force, velocity
                force, velocity, b-field
            */
            if (document.getElementById("unknownSelect").value == "random") {
                var unknowns = ['current', 'magnetic field'];
                var unknown = unknowns[Math.floor(Math.random() * unknowns.length)];
            } else {
                var unknown = document.getElementById("unknownSelect").value
            }
            if (document.getElementById("currentType").value == "loop") {
                var currentDescription = "loop of current";
                var currentDirections = loop_directions;
                var fieldDirections = linear_directions;
            } else if (document.getElementById("currentType").value == "linear") {
                var currentDescription = "linear current";
                var currentDirections = linear_directions;
                var fieldDirections = loop_directions;
            }
            if (unknown == "magnetic field") {
                var known = "current";
                unknownDirections = fieldDirections;
                knownDirections = currentDirections;
                var unknownDescription = `<b>magnetic field</b> due to a <b>${currentDescription}</b>`;
            } else if (unknown == "current") {
                var known = "magnetic field";
                unknownDirections = currentDirections;
                knownDirections = fieldDirections;
                var unknownDescription = `<b>current</b> in a <b>${currentDescription}</b>`;
            }
            knownDir = knownDirections[Math.floor(Math.random() * knownDirections.length)];
            var imgName = `images/field/${document.getElementById("currentType").value}_${known}-${knownDir}.png`;
            document.getElementById("image").src = imgName;
            document.getElementById("feedback").innerHTML = "";
            // document.getElementById("filename").innerHTML = `${imgName}`;
            document.getElementById("textbox").innerHTML = `Use the magnetic field right-hand-rule to predict the direction of the ${unknownDescription} when the <b>${known}</b> is in the <b>${knownDir}</b> direction.`;
            document.getElementById("buttonGridLabel").innerText = `Direction of the ${unknown}:`;
            var buttons = document.querySelectorAll("div.buttonGrid button");

            for (let ibutton = 0; ibutton < buttons.length; ibutton++) {
                const button = buttons[ibutton];
                // do something with the button
                button.style.borderColor = "white";
                button.innerHTML = `${unknownDirections[ibutton]}`;
                button.value = `${unknownDirections[ibutton]}`;
                button.innerHTML = `<img src="images/field/${document.getElementById('currentType').value}_${unknown}-${unknownDirections[ibutton]}.png" alt="${unknown} ${unknownDirections[ibutton]}">`;
            }
        }
    </script>
</head>

<body onload="nextImage()">
    <label for="unknownSelect">Select the unknown direction you would like to solve for:</label>
    <select id="unknownSelect" onchange="nextImage()">
        <option value="current">Current</option>
        <option value="magnetic field">Magnetic field</option>
        <option value="random">Random</option>
    </select>
    <br>
    <label for="currentType">Select the type of current:</label>
    <select id="currentType" onchange="nextImage()">
        <option value="loop">Loop</option>
        <option value="linear">Linear</option>
    </select>
    <p id="textbox" value="" style="width: 50em;"></p>
    <br>
    <p id="filename"></p>
    <img id="image">
    <br>
    <!-- Add this to the body of your HTML file -->
    <label id="buttonGridLabel" for="buttonGrid"></label>
    <div class="buttonGrid">
        <style>
            td {
                text-align: center;
            }
        </style>
        <table>
                <tr>
                    <td>
                        <button id="button1" onclick="checkAnswer(this.id)">
                        </button>
                    </td>
                    <td>
                        <button id="button2" onclick="checkAnswer(this.id)">
                        </button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <button id="button3" onclick="checkAnswer(this.id)">
                        </button>
                    </td>
                    <td>
                        <button id="button4" onclick="checkAnswer(this.id)">
                        </button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <button id="button5" onclick="checkAnswer(this.id)">
                        </button>
                    </td>
                    <td>
                        <button id="button6" onclick="checkAnswer(this.id)">
                        </button>
                    </td>
                </tr>
            </table>
    </div>
    <br>
    <p id="feedback" value=""></p>
    <br>
    <button onclick="nextImage()">Next</button>
</body>

</html>